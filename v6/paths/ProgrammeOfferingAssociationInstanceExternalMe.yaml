post:
  summary: POST /programme-offering-associations/external/me
  operationId: createExternalProgrammeOfferingAssociationByopenId
  description: |
    POST a single programme offering association, enrol a person based on person information obtained from well known endpoint, an offering, 
    and the organisation/type=root information form the organisation that is issuing this association. 
    The offering can either be identified by an offeringId if known or the full offering details. 

    Security must be implemented at the level of the actual deployment rather than in the core specification. 
    This means that the specification remains neutral, while concrete security measures can be applied in 
    practice using established techniques such as OpenID with fine-grained scopes. For example, write access 
    on programme-offering associations for an external user (“me.write”) can be granted in this way. The previous 
    inline declaration has therefore been removed to avoid conflating implementation details with the specification.

  tags:
    - programme offering associations

  requestBody:
    required: true
    content:
      application/json:
        schema:
          required:
            - remoteState
          allOf:
          - $ref: '../schemas/ProgrammeOfferingAssociationExternalMe.yaml'
          - properties:
              issuer:
                $ref: '../schemas/Organisation.yaml'

  responses:
    '201':
      description: CREATED
      content:
        application/json:
          schema:
            allOf:
              - $ref: '../schemas/AssociationId.yaml'
              - $ref: '../schemas/PostResponse.yaml'
              - properties:
                  state:
                    $ref: '../enumerations/associationState.yaml' 


    '400':
      $ref: '../schemas/ErrorBadRequest.yaml'
    '401':
      $ref: '../schemas/ErrorUnauthorized.yaml'
    '403':
      $ref: '../schemas/ErrorForbidden.yaml'
    '404':
      $ref: '../schemas/ErrorNotFound.yaml'
    '406':
      $ref: '../schemas/ErrorNotAcceptable.yaml'
    '405':
      $ref: '../schemas/ErrorMethodNotAllowed.yaml'
    '429':
      $ref: '../schemas/ErrorTooManyRequests.yaml'
    '500':
      $ref: '../schemas/ErrorInternalServerError.yaml'

